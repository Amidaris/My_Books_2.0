{% extends "base.html" %}

{% block title %}Wypo≈ºyczenia{% endblock %}

{% block content %}
    <h3>‚ûï Dodaj wypo≈ºyczenie</h3>
    <form method="POST">
        <label for="book_id">KsiƒÖ≈ºka:</label>
        <select name="book_id" required>
            {% for book in books %}
            <option value="{{ book.id }}">{{ book.title }} ({{ book.author.name }} {{ book.author.surname }})</option>
            {% endfor %}
        </select><br>

        <label for="borrower_name">Imiƒô wypo≈ºyczajƒÖcego:</label>
        <input type="text" name="borrower_name" required><br>

        <label for="borrower_surname">Nazwisko wypo≈ºyczajƒÖcego:</label>
        <input type="text" name="borrower_surname" required><br>

        <button type="submit">Dodaj</button>
    </form>

    <h2>üì¶ Historia wypo≈ºycze≈Ñ</h2>
    <table>
        <tr>
            <th>ID</th>
            <th>KsiƒÖ≈ºka</th>
            <th>Imiƒô</th>
            <th>Nazwisko</th>
            <th>Data wypo≈ºyczenia</th>
            <th>Data zwrotu</th>
            <th>Akcje</th>
        </tr>
        {% for b in borrowings %}
        <tr>
            <td>{{ b.id }}</td>
            <td>{{ b.book.title }}</td>
            <td>{{ b.borrower_name }}</td>
            <td>{{ b.borrower_surname }}</td>
            <td>{{ b.borrow_date.strftime('%Y-%m-%d') }}</td>
            <td>
                {% if b.return_date %}
                {{ b.return_date.strftime('%Y-%m-%d') }}
                {% else %}
                ‚è≥ W trakcie
                {% endif %}
            </td>
            <td>
                {% if not b.return_date %}
                <form method="POST" action="{{ url_for('return_book', borrowing_id=b.id) }}">
                    <button type="submit" onclick="return confirm('Czy na pewno chcesz zwr√≥ciƒá ksiƒÖ≈ºkƒô?')">üîÑ Zwr√≥ƒá</button>
                </form>
                {% else %}
                ‚úÖ Zwr√≥cona
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
{% endblock %}